"use strict";
// eslint-disable-next-line
var chalk = require('chalk');
var getBuiltInPlugins = function (userConfig) {
    if (userConfig.disableRuntime) {
        return [
            'build-plugin-react-app',
            'build-plugin-ice-mpa'
        ];
    }
    // eslint-disable-next-line
    var pkg = require('../package.json');
    process.env.__FRAMEWORK_VERSION__ = pkg.version;
    var coreOptions = {
        'framework': 'react',
        'alias': process.env.__FRAMEWORK_NAME__ || 'ice'
    };
    var plugins = [
        // common plugins
        ['build-plugin-app-core', coreOptions],
        // react base plugin
        'build-plugin-react-app',
        // for ice/miniapp plugins
        'build-plugin-miniapp',
        // for ice/react plugins
        'build-plugin-ice-router',
        'build-plugin-ice-helpers',
        'build-plugin-ice-logger',
        'build-plugin-ice-config',
        'build-plugin-ice-mpa',
        'build-plugin-ice-request',
        'build-plugin-helmet'
    ];
    if (userConfig.ssr) {
        plugins.push('build-plugin-ice-ssr');
    }
    // add store plugin
    if (!Object.prototype.hasOwnProperty.call(userConfig, 'store') || userConfig.store !== false) {
        plugins.push('build-plugin-ice-store');
    }
    var ICE_AUTH_PLUGIN_KEY = 'build-plugin-ice-auth';
    var existIceAuthPlugin = userConfig.plugins && userConfig.plugins.some(function (plugin) {
        if (typeof plugin === 'string') {
            return plugin === ICE_AUTH_PLUGIN_KEY;
        }
        else if (Array.isArray(plugin)) {
            return plugin[0] === ICE_AUTH_PLUGIN_KEY;
        }
        else {
            return false;
        }
    });
    if (existIceAuthPlugin) {
        console.log('');
        console.log(chalk.magenta('The build-plugin-ice-auth has been built in. Please remove it from build.json.'));
        console.log('');
    }
    else if (userConfig.auth !== false) {
        plugins.push('build-plugin-ice-auth');
    }
    return plugins;
};
module.exports = getBuiltInPlugins;
